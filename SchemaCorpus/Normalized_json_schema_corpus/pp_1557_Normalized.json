{
  "id": "https://schema.management.azure.com/schemas/2015-06-01/Microsoft.KeyVault.json#",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Microsoft.KeyVault",
  "description": "Microsoft KeyVault Resource Types",
  "resourceDefinitions": {
    "secrets": {
      "type": "object",
      "properties": {
        "type": {
          "enum": [
            "Microsoft.KeyVault/vaults/secrets"
          ]
        },
        "apiVersion": {
          "enum": [
            "2014-12-19-preview",
            "2015-06-01"
          ]
        },
        "properties": {
          "type": "object",
          "properties": {
            "value": {
              "type": "string",
              "description": "Secret value"
            }
          },
          "required": [
            "value"
          ]
        }
      },
      "required": [
        "apiVersion",
        "properties",
        "type"
      ],
      "description": "Microsoft.KeyVault/vaults/secrets"
    },
    "secretsChild": {
      "type": "object",
      "properties": {
        "type": {
          "enum": [
            "secrets"
          ]
        },
        "apiVersion": {
          "enum": [
            "2014-12-19-preview",
            "2015-06-01"
          ]
        },
        "properties": {
          "type": "object",
          "properties": {
            "value": {
              "type": "string",
              "description": "Secret value"
            }
          },
          "required": [
            "value"
          ]
        }
      },
      "required": [
        "apiVersion",
        "properties",
        "type"
      ],
      "description": "Microsoft.KeyVault/vaults/secretsChild"
    },
    "vaults": {
      "type": "object",
      "properties": {
        "type": {
          "enum": [
            "Microsoft.KeyVault/vaults"
          ]
        },
        "apiVersion": {
          "enum": [
            "2014-12-19-preview",
            "2015-06-01"
          ]
        },
        "properties": {
          "type": "object",
          "properties": {
            "sku": {
              "oneOf": [
                {
                  "$ref": "#/definitions/sku"
                },
                {
                  "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
                }
              ],
              "description": "Microsoft.KeyVault/vaults: Sku"
            },
            "tenantId": {
              "oneOf": [
                {
                  "type": "string",
                  "pattern": "^[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$"
                },
                {
                  "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
                }
              ],
              "description": "Microsoft.KeyVault/vaults: The tenant ID of the Azure Active Directory Tenant to use for authorization."
            },
            "accessPolicies": {
              "oneOf": [
                {
                  "type": "array",
                  "items": {
                    "$ref": "#/definitions/accessPolicy"
                  }
                },
                {
                  "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
                }
              ],
              "description": "Microsoft.KeyVault/vaults: Access policies"
            },
            "enabledForDeployment": {
              "oneOf": [
                {
                  "type": "boolean"
                },
                {
                  "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
                }
              ],
              "description": "Microsoft.KeyVault/vaults: Enabled for deployment"
            }
          },
          "required": [
            "tenantId",
            "sku",
            "accessPolicies"
          ]
        },
        "resources": {
          "type": "array",
          "items": {
            "allOf": [
              {
                "$ref": "#/definitions/..\\common\\definitions.json_definitions_resourceBase"
              },
              {
                "$ref": "#/definitions/resourceDefinitions_secretsChild"
              }
            ]
          },
          "description": "Microsoft.KeyVault/vaults: Child resources"
        }
      },
      "required": [
        "apiVersion",
        "properties",
        "type"
      ],
      "description": "Microsoft.KeyVault/vaults"
    }
  },
  "definitions": {
    "accessPolicy": {
      "type": "object",
      "properties": {
        "tenantId": {
          "oneOf": [
            {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
            },
            {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$"
            }
          ],
          "description": "Microsoft.KeyVault/vaults: The tenant ID of the Azure Active Directory Tenant containing the objectId in this access policy."
        },
        "objectId": {
          "oneOf": [
            {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
            },
            {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$"
            }
          ],
          "description": "Microsoft.KeyVault/vaults: The object ID of the Azure Active Directory object to apply this access policy to.  For example, the object ID of a Service Principal, or of a User Principal."
        },
        "permissions": {
          "$ref": "#/definitions/permissions"
        }
      },
      "required": [
        "tenantId",
        "objectId",
        "permissions"
      ]
    },
    "permissions": {
      "type": "object",
      "properties": {
        "keys": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "enum": [
                  "all",
                  "backup",
                  "create",
                  "decrypt",
                  "delete",
                  "encrypt",
                  "get",
                  "import",
                  "list",
                  "restore",
                  "sign",
                  "unwrapKey",
                  "update",
                  "verify",
                  "wrapKey"
                ]
              },
              "minItems": 1
            },
            {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
            }
          ],
          "description": "Microsoft.KeyVault/vaults: The permissions granted on keys in this vault to this Active Directory object."
        },
        "secrets": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "enum": [
                  "all",
                  "delete",
                  "get",
                  "list",
                  "set"
                ]
              },
              "minItems": 1
            },
            {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
            }
          ],
          "description": "Microsoft.KeyVault/vaults: The permissions granted on secrets in this vault to this Active Directory object."
        }
      },
      "anyOf": [
        {
          "required": [
            "secrets"
          ]
        },
        {
          "required": [
            "keys"
          ]
        }
      ],
      "description": "Microsoft.KeyVault/vaults: The permissions granted on this vault to this Active Directory object."
    },
    "sku": {
      "type": "object",
      "properties": {
        "name": {
          "oneOf": [
            {
              "enum": [
                "standard",
                "premium"
              ]
            },
            {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
            }
          ],
          "description": "Microsoft.KeyVault/vaults: The service tier of KeyVault to use.  Standard supports secrets and software-protected keys.  Premium adds support for HSM-protected keys."
        },
        "family": {
          "oneOf": [
            {
              "enum": [
                "A"
              ]
            },
            {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
            }
          ],
          "description": "Microsoft.KeyVault/vaults: The SKU family to use."
        }
      },
      "required": [
        "family",
        "name"
      ]
    },
    "..\\common\\definitions.json_definitions_expression": {
      "type": "string",
      "pattern": "^\\[([^\\[].*)?\\]$",
      "description": "Deployment template expression. See https://aka.ms/arm-template-expressions for more details on the ARM expression syntax."
    },
    "..\\common\\definitions.json_definitions_resourceBase": {
      "allOf": [
        {
          "$ref": "#/definitions/..\\common\\definitions.json_definitions_ARMResourceBase"
        },
        {
          "properties": {
            "location": {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_resourceLocations",
              "description": "Location to deploy resource to"
            },
            "tags": {
              "type": "object",
              "description": "Name-value pairs to add to the resource"
            },
            "copy": {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_resourceCopy"
            },
            "comments": {
              "type": "string"
            }
          }
        }
      ]
    },
    "..\\common\\definitions.json_definitions_ARMResourceBase": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the resource"
        },
        "type": {
          "type": "string",
          "description": "Resource type"
        },
        "condition": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
            }
          ],
          "description": "Condition of the resource"
        },
        "apiVersion": {
          "type": "string",
          "description": "API Version of the resource type, optional when apiProfile is used on the template"
        },
        "dependsOn": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Collection of resources this resource depends on"
        }
      },
      "required": [
        "name",
        "type"
      ]
    },
    "..\\common\\definitions.json_definitions_resourceLocations": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "enum": [
            "East Asia",
            "Southeast Asia",
            "Central US",
            "East US",
            "East US 2",
            "West US",
            "North Central US",
            "South Central US",
            "North Europe",
            "West Europe",
            "Japan West",
            "Japan East",
            "Brazil South",
            "Australia East",
            "Australia Southeast",
            "Central India",
            "West India",
            "South India",
            "Canada Central",
            "Canada East",
            "West Central US",
            "West US 2",
            "UK South",
            "UK West",
            "Korea Central",
            "Korea South",
            "global"
          ]
        }
      ]
    },
    "..\\common\\definitions.json_definitions_resourceCopy": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the copy"
        },
        "count": {
          "oneOf": [
            {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
            },
            {
              "type": "integer"
            }
          ],
          "description": "Count of the copy"
        },
        "mode": {
          "type": "string",
          "enum": [
            "Parallel",
            "Serial"
          ],
          "description": "The copy mode"
        },
        "batchSize": {
          "oneOf": [
            {
              "$ref": "#/definitions/..\\common\\definitions.json_definitions_expression"
            },
            {
              "type": "integer"
            }
          ],
          "description": "The serial copy batch size"
        }
      }
    },
    "resourceDefinitions_secretsChild": {
      "type": "object",
      "properties": {
        "type": {
          "enum": [
            "secrets"
          ]
        },
        "apiVersion": {
          "enum": [
            "2014-12-19-preview",
            "2015-06-01"
          ]
        },
        "properties": {
          "type": "object",
          "properties": {
            "value": {
              "type": "string",
              "description": "Secret value"
            }
          },
          "required": [
            "value"
          ]
        }
      },
      "required": [
        "apiVersion",
        "properties",
        "type"
      ],
      "description": "Microsoft.KeyVault/vaults/secretsChild"
    }
  }
}