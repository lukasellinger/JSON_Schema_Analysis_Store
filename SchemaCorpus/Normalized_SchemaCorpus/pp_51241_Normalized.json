{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "kill-chain-phase",
  "description": "A single phase in a cyber kill chain",
  "type": "object",
  "allOf": [
    {
      "$ref": "#/definitions/..\\common\\describable.json"
    },
    {
      "$ref": "#/definitions/..\\common\\referenceable.json"
    },
    {
      "properties": {
        "id": {
          "type": "string",
          "description": "The ID of this kill chain phase"
        }
      }
    }
  ],
  "relationships": {
    "related": [
      "asset",
      "attack-pattern",
      "campaign",
      "configuration",
      "course-of-action",
      "identity",
      "incident",
      "indicator",
      "kill-chain",
      "kill-chain-phase",
      "malicious-infrastructure",
      "malicious-tool",
      "malware",
      "observation",
      "threat-actor",
      "tool",
      "victim-targeting",
      "vulnerability",
      "weakness"
    ],
    "duplicate-of": [
      "kill-chain-phase"
    ],
    "suggested-update": [
      "kill-chain-phase"
    ],
    "derived-from": [
      "kill-chain-phase"
    ]
  },
  "tlo": false,
  "definitions": {
    "..\\common\\describable.json": {
      "$schema": "http://json-schema.org/draft-04/schema#",
      "title": "describable",
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "description": "A title for this construct"
        },
        "description": {
          "type": "string",
          "description": "A description for this construct"
        }
      },
      "required": [
        "title"
      ]
    },
    "..\\common\\referenceable.json": {
      "$schema": "http://json-schema.org/draft-04/schema#",
      "title": "referenceable",
      "type": "object",
      "references": {
        "type": "array",
        "items": {
          "AllOf": [
            {
              "properties": {
                "reference_type ": {
                  "type": "string",
                  "enum": [
                    "original-source",
                    "analysis-of-original"
                  ],
                  "description": "An enum detailing what type of information is referenced"
                },
                "reference_title": {
                  "type": "string",
                  "description": "A human-readable title for this object"
                },
                "reference_url": {
                  "type": "string",
                  "description": "A URL pointing to a copy of the documentation that the reference refers to"
                },
                "analysis_by_ref": {
                  "type": "string",
                  "description": "A direct reference containing the Object ID of the Identity who produced or performed the analysis contained in the referenced document. This is not the Identity of who created the STIX Object, but is who performed the analaysis contained in the referenced document. This Object is not related using a Relationship Object as an intermediatary"
                }
              }
            }
          ]
        }
      }
    }
  }
}